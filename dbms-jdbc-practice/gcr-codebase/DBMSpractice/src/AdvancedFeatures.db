//Exercise 3: Advanced Features
Build a library management system with:
• Book inventory
• Student borrowing records
• Fine calculation
• Search functionality with multiple filters

--------------------------------------------------------------------------------------------------------------
//• Book inventory
//• Student borrowing records
//• Fine calculation

mysql> CREATE TABLE books (
    ->     book_id INT PRIMARY KEY AUTO_INCREMENT,
    ->     title VARCHAR(100) NOT NULL,
    ->     author VARCHAR(100),
    ->     category VARCHAR(50),
    ->     total_copies INT NOT NULL,
    ->     available_copies INT NOT NULL
    -> );


mysql> CREATE TABLE students (
    ->     student_id INT PRIMARY KEY AUTO_INCREMENT,
    ->     name VARCHAR(100) NOT NULL,
    ->     department VARCHAR(50)
    -> );


mysql> CREATE TABLE borrow_records (
    ->     borrow_id INT PRIMARY KEY AUTO_INCREMENT,
    ->     student_id INT,
    ->     book_id INT,
    ->     borrow_date DATE,
    ->     due_date DATE,
    ->     return_date DATE,
    ->     fine DECIMAL(6,2) DEFAULT 0,
    ->
    ->     FOREIGN KEY (student_id) REFERENCES students(student_id),
    ->     FOREIGN KEY (book_id) REFERENCES books(book_id)
    -> );


mysql> UPDATE borrow_records
    -> SET fine = DATEDIFF(return_date, due_date) * 5
    -> WHERE return_date > due_date;


mysql>

---------------------------------------------------------------------------------------------------------------
// • Implementations and Search functionality with multiple filters



mysql> INSERT INTO students (name, department)
    -> VALUES ('Rahul', 'CS');
Query OK, 1 row affected (0.01 sec)

mysql> INSERT INTO books (title, author, category, total_copies, available_copies)
    -> VALUES ('Java Basics', 'Kumar', 'Programming', 5, 5);
Query OK, 1 row affected (0.01 sec)

mysql> START TRANSACTION;
Query OK, 0 rows affected (0.00 sec)

mysql>
mysql> UPDATE books
    -> SET available_copies = available_copies - 1
    -> WHERE book_id = 1 AND available_copies > 0;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql>
mysql> INSERT INTO borrow_records (student_id, book_id, borrow_date, due_date)
    -> VALUES (1, 1, CURDATE(), DATE_ADD(CURDATE(), INTERVAL 7 DAY));
Query OK, 1 row affected (0.00 sec)

mysql>
mysql> COMMIT;
Query OK, 0 rows affected (0.00 sec)

mysql>

------------------------------------------------------------------------------------------------------------------




mysql> SELECT * FROM STUDENTS;
+------------+-------+------------+
| student_id | name  | department |
+------------+-------+------------+
|          1 | Rahul | CS         |
+------------+-------+------------+
1 row in set (0.01 sec)

mysql> SELECT * FROM BOOKS;
+---------+-------------+--------+-------------+--------------+------------------+
| book_id | title       | author | category    | total_copies | available_copies |
+---------+-------------+--------+-------------+--------------+------------------+
|       1 | Java Basics | Kumar  | Programming |            5 |                4 |
+---------+-------------+--------+-------------+--------------+------------------+
1 row in set (0.00 sec)


mysql> SELECT * FROM borrow_records;
+-----------+------------+---------+-------------+------------+-------------+------+
| borrow_id | student_id | book_id | borrow_date | due_date   | return_date | fine |
+-----------+------------+---------+-------------+------------+-------------+------+
|         2 |          1 |       1 | 2026-02-09  | 2026-02-16 | NULL        | 0.00 |
+-----------+------------+---------+-------------+------------+-------------+------+
1 row in set (0.00 sec)

mysql>  

--------------------------------------------------------------------------------------------------------------
// • Fine calculation

mysql> INSERT INTO borrow_records (student_id, book_id, borrow_date, due_date,return_date)
    -> values (1, 1, CURDATE(), DATE_ADD(CURDATE(), INTERVAL 7 DAY), '2026-04-12');
Query OK, 1 row affected (0.01 sec)

mysql> SELECT * FROM borrow_records;
+-----------+------------+---------+-------------+------------+-------------+------+
| borrow_id | student_id | book_id | borrow_date | due_date   | return_date | fine |
+-----------+------------+---------+-------------+------------+-------------+------+
|         2 |          1 |       1 | 2026-02-09  | 2026-02-16 | NULL        | 0.00 |
|         3 |          1 |       1 | 2026-02-09  | 2026-02-19 | NULL        | 0.00 |
|         4 |          1 |       1 | 2026-02-09  | 2026-02-16 | 2026-04-12  | 0.00 |
+-----------+------------+---------+-------------+------------+-------------+------+
3 rows in set (0.00 sec)

mysql> UPDATE borrow_records
    -> SET fine = DATEDIFF(return_date, due_date) * 5
    -> WHERE return_date IS NOT NULL
    -> AND return_date > due_date;
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> SELECT * FROM borrow_records;
+-----------+------------+---------+-------------+------------+-------------+--------+
| borrow_id | student_id | book_id | borrow_date | due_date   | return_date | fine   |
+-----------+------------+---------+-------------+------------+-------------+--------+
|         2 |          1 |       1 | 2026-02-09  | 2026-02-16 | NULL        |   0.00 |
|         3 |          1 |       1 | 2026-02-09  | 2026-02-19 | NULL        |   0.00 |
|         4 |          1 |       1 | 2026-02-09  | 2026-02-16 | 2026-04-12  | 275.00 |
+-----------+------------+---------+-------------+------------+-------------+--------+
3 rows in set (0.00 sec)


-------------------------------------------------------------------------------------------------------------------

//• Search functionality with multiple filters


mysql> SELECT * FROM books
    -> WHERE author LIKE '%Kumar%'
    -> AND category = 'Programming'
    -> AND available_copies > 0;
+---------+-------------+--------+-------------+--------------+------------------+
| book_id | title       | author | category    | total_copies | available_copies |
+---------+-------------+--------+-------------+--------------+------------------+
|       1 | Java Basics | Kumar  | Programming |            5 |                4 |
+---------+-------------+--------+-------------+--------------+------------------+
1 row in set (0.01 sec)

mysql>


